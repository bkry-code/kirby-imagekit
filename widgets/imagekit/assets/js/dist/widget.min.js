!function(e,t,i){function n(e){function t(e,t,n,a){a=a||"GET",n=n||{},t=t||function(){};var r=c.api+e;return i.ajax({url:r,dataType:"json",method:a,data:n,success:function(e){t(e)},error:function(e){console.warn(e)}})}function n(e){return t("status",e)}function a(e){return t("clear",e)}function r(e){return t("create",e)}var c=e;return{status:n,clear:a,create:r}}function a(i){function a(e){return void 0===e?p:(p=e,self)}function r(e){e&&v.removeAttribute("value"),v.classList[e?"remove":"add"]("is-hidden")}function c(t){if(t.preventDefault(),!a()){var i=e.confirm(e.ImageKitSettings.translations["imagekit.widget.clear.confirm"]);i&&(a(!0),r(!0),f.classList.add("imagekit-action--disabled"),d.clear(function(e){a(!1),s(e),r(!1),f.classList.remove("imagekit-action--disabled")}))}}function o(e){function t(){d.create(function(e){s(e),e.data.pending>0&&a()?t():(a(!1),r(!1),g.className="icon icon-left fa fa-play-circle-o",f.classList.remove("imagekit-action--disabled"))})}return e.preventDefault(),a()?(a(!1),void(g.className="icon icon-left fa fa-play-circle-o")):(a(!0),g.className="icon icon-left fa fa-stop-circle-o",f.classList.add("imagekit-action--disabled"),r(!0),void t())}function s(e){if(l=e.data,l.pending>0||l.created>0){var i=1-l.pending/(l.pending+l.created);v.setAttribute("value",i)}else v.removeAttribute("value");t.querySelector(".js-imagekit-created").innerHTML=l.created,t.querySelector(".js-imagekit-pending").innerHTML=l.pending}function u(){a()||d.status(function(e){s(e)})}var l,d=new n(ImageKitSettings),f=(t.querySelector(".js-imagekit-info"),t.querySelector('[href="#imagekit-action-clear"]')),m=t.querySelector('[href="#imagekit-action-create"]'),g=m.getElementsByTagName("i")[0],v=t.querySelector(".js-imagekit-progress"),p=!1;return f.addEventListener("click",c),m.addEventListener("click",o),{status:u}}i(function(){var e=new a;e.status()})}(window,document,jQuery);